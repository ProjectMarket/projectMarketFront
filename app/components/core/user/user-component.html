<div ng-if="$ctrl.vm.canDisplayView" layout-padding layout-margin layout="row">

    <md-card flex="30">

    </md-card>

    <md-card  flex="70" style="min-height: 500px;">
        <md-content>
            <md-tabs md-dynamic-height >
                <md-tab>
                    <md-tab-label>
                        <md-icon md-svg-icon="layout:signup"></md-icon>
                        Activité
                    </md-tab-label>
                    <md-tab-body>

                    </md-tab-body>
                </md-tab>
                <md-tab>
                    <md-tab-label>
                        <md-icon md-svg-icon="layout:signup"></md-icon>
                        Messagerie
                    </md-tab-label>
                </md-tab>
                <md-tab >
                    <md-tab-label>
                        <md-icon md-svg-icon="layout:signup"></md-icon>
                        Paramètres
                    </md-tab-label>
                    <md-tab-body>
                        <div layout="row" flex class="content-wrapper">
                            <md-sidenav layout="column" class="md-sidenav-left  primary-col " md-component-id="left" md-is-locked-open="$mdMedia('gt-sm')">
                              <md-list class="muppet-list">
                                <md-item ng-repeat="it in $ctrl.vm.muppets">
                                  <md-item-content>
                                    <md-button ng-click="$ctrl.vm.selectMuppet(it)" ng-class="{'selected' : it === $ctrl.vm.selected }">
                                     
                                      {{it.name}}
                                    </md-button>
                                  </md-item-content>
                                </md-item>
                              </md-list>
                            </md-sidenav>
                            <div layout="column" flex class="content-wrapper" id="primary-col">
                                <md-content layout="column" flex class="md-padding" ng-if="$ctrl.vm.selected.name == 'Profil'">
                                    <form name="profilForm">
                                        <h2>{{$ctrl.vm.selected.name}}</h2>
                                        <p>Modifiez les paramètres de votre profil.</p>

                                        
                                        <md-list>
                                            <md-list-item>
                                                <label>Avatar : </label>
                                                <img ng-src="../../../assets/img/utilisateur.png" class="md-avatar" alt="utilisateur">
                                            </md-list-item>
                                        </md-list>

                                         <md-divider></md-divider>

                                        <md-input-container>
                                            <label>Description</label>
                                            <textarea ng-model="$ctrl.vm.userAccount.biography" md-maxlength="150" rows="5" md-select-on-focus></textarea>

                                        </md-input-container>
                                        <md-input-container class="md-block">
                                        <label>Addresse</label>
                                        <input ng-model="$ctrl.vm.userAccount.address">
                                        </md-input-container>

                                        <md-input-container md-no-float class="md-block">
                                            <label>Complement d'adresse</label>
                                            <input ng-model="$ctrl.vm.userAccount.address2">
                                        </md-input-container>

                                            <div layout-gt-sm="row">
                                                <md-input-container class="md-block" flex-gt-sm>
                                                    <label>Ville</label>
                                                    <input ng-model="$ctrl.vm.userAccount.city">
                                                </md-input-container>

                                                <md-input-container class="md-block" flex-gt-sm>
                                                    <label>Pays</label>
                                                    <md-select ng-model="$ctrl.vm.userAccount.state">
                                                        <md-option ng-repeat="pays in $ctrl.vm.pays" value="{{pays}}">
                                                            {{pays}}
                                                        </md-option>
                                                    </md-select>
                                                </md-input-container>

                                                <md-input-container class="md-block" flex-gt-sm>
                                                    <label>Code postal</label>
                                                    <input type="text" ng-model="$ctrl.vm.userAccount.postalCode">
                                                </md-input-container>
                                            </div>

                                        <md-divider></md-divider>

                                        <md-input-container class="md-block" flex-gt-sm>
                                            <label>Compétences</label>
                                            <input type="text" ng-model="$ctrl.vm.userAccount.skill">
                                        </md-input-container>
                                    </form>
                                </md-content>
                                <md-content layout="column" flex class="md-padding" ng-if="$ctrl.vm.selected.name == 'Compte'">
                                    <form name="userFormMail" layout="column">
                                        <h3>{{$ctrl.vm.selected.name}}</h3>
                                        <p> Modifiez votre mail et/ou votre mot de passe</p>
                                                                 
                                        <md-input-container>                                   
                                            <md-icon md-svg-src="../../../assets/img/icons/ic_email_24px.svg" class="email"></md-icon>
                                            
                                            <input type="email" name="email" required ng-model="$ctrl.vm.userAccount.email"  placeholder="E-Mail" ng-pattern="/^[a-zA-Z0-9._-]+@[a-z0-9._-]{2,}\.[a-z]{2,4}$/">

                                            <div ng-messages="userFormMail.email.$error">
                                                <div ng-message="pattern">Adresse E-mail incorrecte</div>
                                                <div ng-message="required">Merci de saisir une adresse E-mail.</div>
                                            </div>
                                        </md-input-container>


                                        <md-button class="md-raised md-warn"
                                        ng-disabled="!userFormMail.$valid"
                                        ng-click="$ctrl.vm.changeMail()">
                                            Modifier adresse e-mail
                                        </md-button>
                                    </form>
                                    <form name=userFormPassword layout="column">
                                        <md-input-container>
                                            <label>Mot de passe actuel</label>
                                            <input type="password" ng-model="$ctrl.vm.userAccount.oldpassword" 
                                            name="password"
                                            required ng-minlength="4">
                                            <div ng-messages="userFormPassword.password.$error" 
                                                ng-if="userFormPassword.password.$touched"
                                                class="pm-front-validation-messages">
                                                <div ng-message="required">Merci de saisir un mot de passe.</div>
                                                <div ng-message="minlength">Le mot de passe doit contenir au minimum 4 caractères.</div>
                                            </div>
                                        </md-input-container>

                                        <md-input-container>
                                            <label>Nouveau mot de passe</label>
                                            <input type="password" ng-model="$ctrl.vm.userAccount.newpassword"
                                            name="new_password"
                                            required ng-minlength="4">
                                            <div ng-messages="userFormPassword.new_password.$error" 
                                                ng-if="userFormPassword.new_password.$touched"
                                                class="pm-front-validation-messages">
                                                <div ng-message="required">Merci de saisir un mot de passe.</div>
                                                <div ng-message="minlength">Le mot de passe doit contenir au minimum 4 caractères.</div>
                                            </div>
                                        </md-input-container>
                                        
                                        <md-input-container>
                                            <label>Confimation</label>
                                            <input type="password" ng-model="$ctrl.vm.userAccount.passwordConfirm"  
                                            name="confirm_password"
                                            compare-to="$ctrl.vm.userAccount.newpassword"
                                            >
                                            <div ng-messages="userFormPassword.confirm_password.$error"
                                                 ng-if="userFormPassword.confirm_password.$dirty"
                                                 class="pm-front-validation-messages">
                                            <div ng-message="compareTo" 
                                                ng-if="userFormPassword.confirm_password.$dirty">Les mots de passes indiqués ne sont pas identiques.</div>
                                            </div>
                                        </md-input-container>
                                    
                                        <md-button class="md-raised md-warn"
                                        ng-disabled="!userFormPassword.$valid"
                                        ng-click="$ctrl.vm.changePassword()">
                                            Modifier mot de passe
                                        </md-button>
                                    </form>
                                </md-content>

                                    <md-content layout="column" flex class="md-padding" ng-if="$ctrl.vm.selected.name == 'Suppression'">
                                    <h3>{{$ctrl.vm.selected.name}}</h3>
                                    <p> Pour supprimer votre compte, merci d'inscrire "SUPPRIMER" dans le champs ci-dessous</p>
                                                             
                                    <md-input-container>
                                        <input type="text" ng-model="$ctrl.vm.userAccount.suppression"  placeholder="SUPPRIMER">
                                    </md-input-container>

                                    <md-button class="md-raised md-warn"
                                    ng-click="$ctrl.vm.changePassword()">
                                        SUPPRIMER
                                    </md-button>

                                </md-content>
                            </div>
                        </div>
                        <script>
                            function openCity(evt, paramsName) {
                                var i, x, tablinks;
                                x = document.getElementsByClassName("params");
                                for (i = 0; i < x.length; i++) {
                                    x[i].style.display = "none";
                                }
                                tablinks = document.getElementsByClassName("tablink");
                                for (i = 0; i < x.length; i++) {
                                    tablinks[i].className = tablinks[i].className.replace(" w3-red", "");
                                }
                                document.getElementById(paramsName).style.display = "block";
                                evt.currentTarget.className += " w3-red";
                            }
                        </script>
                    </md-tab-body>  
                </md-tab>
            </md-tabs>
        </md-content>
    </md-card>

</div>